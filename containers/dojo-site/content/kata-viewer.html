<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Java Abstraction Kata Viewer - Coding Dojo</title>
    
    <!-- Primary CDN sources -->
    <script src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js" onerror="console.error('Failed to load Marked.js from primary CDN')"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js" onerror="console.error('Failed to load Mermaid.js from primary CDN')"></script>
    
    <!-- Prism.js for reliable syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    
    <script>
        console.log('Prism.js loaded, ready for syntax highlighting');
        
        // Prism is available immediately, no async loading needed
        window.prismReady = true;
        
        // Configure Prism
        Prism.manual = true; // Disable automatic highlighting
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, Prism ready for manual highlighting');
        });
    </script>
    
    <!-- Fallback CDN sources -->
    <script>
        // Fallback loading for Marked.js
        if (typeof marked === 'undefined') {
            console.log('Loading Marked.js fallback...');
            const script1 = document.createElement('script');
            script1.src = 'https://unpkg.com/marked@4.3.0/marked.min.js';
            script1.onerror = () => console.error('Marked.js fallback also failed');
            document.head.appendChild(script1);
        }
        
        // Shiki is loaded via ES modules above - no fallback needed
        
        // Fallback loading for Mermaid.js
        if (typeof mermaid === 'undefined') {
            console.log('Loading Mermaid.js fallback...');
            const script3 = document.createElement('script');
            script3.src = 'https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js';
            script3.onerror = () => console.error('Mermaid.js fallback also failed');
            document.head.appendChild(script3);
        }
    </script>
    <script>
        // Initialize mermaid when loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Shiki initialization is handled in ES module above
            console.log('DOM loaded, Shiki will be available via window.shikiPromise');
            
            if (typeof mermaid !== 'undefined') {
                mermaid.initialize({ 
                    startOnLoad: false,
                    theme: 'dark',
                    themeVariables: {
                        fontFamily: 'monospace',
                        fontSize: '14px'
                    }
                });
                console.log('Mermaid initialized successfully');
            } else {
                console.warn('Mermaid not available - diagram rendering disabled');
            }
        });
    </script>
    <link rel="stylesheet" href="css/dojo-common.css">
    <link rel="stylesheet" href="css/kata-viewer.css">
    
    <!-- External JavaScript files -->
    <script src="js/kata-viewer.js"></script>
    <script src="js/kata-init.js"></script>
</head>
<body>
    <!-- Floating decorative elements -->
    <div class="floating-element element-1">道</div>
    <div class="floating-element element-2">武</div>
    <div class="floating-element element-3">心</div>
    
    <!-- Navigation Bar -->
    <nav class="top-nav">
        <a href="index.html" class="nav-home">← Back to Dojo</a>
    </nav>

    <div class="kata-container">
        <div class="sidebar">
            <h2>Java Abstraction and Generics Katas</h2>
            <div class="japanese" style="text-align: center; font-size: 2rem; color: #ffd700; margin-bottom: 20px;">練習</div>
            <ul class="kata-list" id="kataList">
                <!-- Katas will be loaded here -->
            </ul>
        </div>
        
        <div class="main-content">
            <div class="kata-viewer" id="kataViewer">
                <div class="welcome">
                    <div class="japanese">道場</div>
                    <div class="sensei-container">
                        <img src="images/sensei.png" alt="Sensei" class="sensei-image" />
                    </div>
                    <h2>Welcome to Java Abstraction and Generics Kata Dojo</h2>
                    <p>Master the art of Java abstraction and generics through progressive training exercises. Each kata builds upon the previous, guiding you from basic concepts to advanced patterns.</p>
                    <p><strong>Your Journey:</strong> Start with fundamental abstraction principles, progress through interface design and polymorphism, then advance to bounded generics, wildcards, and the PECS principle.</p>
                    <p>Each kata combines practical coding challenges with the wisdom of sensei-deshi dialogue, helping you understand not just <em>how</em> to use these concepts, but <em>when</em> and <em>why</em> to apply them.</p>
                    <p><em>"In abstraction, we find the essence of things, free from the burden of specific implementation."</em></p>
                    <div class="ninja-fight-container">
                        <img src="images/ninjas-fight.png" alt="Ninjas Training" class="ninja-fight-image" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
